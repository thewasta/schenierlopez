---
// Tech Stack Section - Corporate Tech Noir Design
// Horizontal Infinite Scroll Implementation

// Import icon components
import LaravelIcon from '../icons/LaravelIcon.astro';
import SymfonyIcon from '../icons/SymfonyIcon.astro';
import NestJSIcon from '../icons/NestJSIcon.astro';
import ExpressIcon from '../icons/ExpressIcon.astro';
import PhpIcon from '../icons/PhpIcon.astro';
import MysqlIcon from '../icons/MysqlIcon.astro';
import AnsibleIcon from '../icons/AnsibleIcon.astro';
import KibanaIcon from '../icons/KibanaIcon.astro';

const iconComponents = {
  laravel: LaravelIcon,
  symfony: SymfonyIcon,
  nestjs: NestJSIcon,
  express: ExpressIcon,
  php: PhpIcon,
  mysql: MysqlIcon,
  ansible: AnsibleIcon,
  kibana: KibanaIcon,
};

// Keep inline SVGs for icons without dedicated files
const inlineIcons = {
  docker: `<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="w-full h-full"><path d="M22 12.54c-1.804 -.345 -2.701 -1.08 -3.523 -2.94c-.487 .696 -1.102 1.568 -.92 2.4c.028 .238 -.32 1 -.557 1h-14c0 5.208 3.164 7 6.196 7c4.124 .022 7.828 -1.376 9.854 -5c1.146 -.101 2.296 -1.505 2.95 -2.46z" /><path d="M5 10h3v3h-3z" /><path d="M8 10h3v3h-3z" /><path d="M11 10h3v3h-3z" /><path d="M8 7h3v3h-3z" /><path d="M11 7h3v3h-3z" /><path d="M11 4h3v3h-3z" /><path d="M4.571 18c1.5 0 2.047 -.074 2.958 -.78" /><path d="M10 16l0 .01" /></svg>`,
  redis: `<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="w-full h-full"><path d="M4 6c0 1.657 3.582 3 8 3s8 -1.343 8 -3s-3.582 -3 -8 -3s-8 1.343 -8 3" /><path d="M4 6v6c0 1.657 3.582 3 8 3s8 -1.343 8 -3v-6" /><path d="M4 12v6c0 1.657 3.582 3 8 3s8 -1.343 8 -3v-6" /></svg>`,
  mongo: `<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="w-full h-full"><path d="M12 3v19" /><path d="M6 8.5l6 -5.5l6 5.5v9l-6 5.5l-6 -5.5z" /></svg>`,
  git: `<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="w-full h-full"><circle cx="16" cy="12" r="2" /><circle cx="10" cy="8" r="2" /><circle cx="10" cy="16" r="2" /><path d="M10 8v8" /><path d="M16 12l-4 -4" /></svg>`,
  elasticsearch: `<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="w-full h-full"><path d="M14 2a5 5 0 0 1 5 5c0 .712 -.232 1.387 -.5 2c1.894 .042 3.5 1.595 3.5 3.5c0 1.869 -1.656 3.4 -3.5 3.5c.333 .625 .5 1.125 .5 1.5a2.5 2.5 0 0 1 -2.5 2.5c-.787 0 -1.542 -.432 -2 -1c-.786 1.73 -2.476 3 -4.5 3a5 5 0 0 1 -4.583 -7a3.5 3.5 0 0 1 -.11 -6.992l.195 0a2.5 2.5 0 0 1 2 -4c.787 0 1.542 .432 2 1c.786 -1.73 2.476 -3 4.5 -3z" /><path d="M8.5 9l-3 -1" /><path d="M9.5 5l-1 4l1 2l5 2l4 -4" /><path d="M18.499 16l-3 -.5l-1 -2.5" /><path d="M14.5 19l1 -3.5" /><path d="M5.417 15l4.083 -4" /></svg>`,
  microservices: `<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="w-full h-full"><rect x="3" y="4" width="18" height="4" rx="2" /><rect x="3" y="12" width="18" height="4" rx="2" /><rect x="3" y="20" width="18" height="4" rx="2" /></svg>`,
  code: `<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="w-full h-full"><path d="M7 8l-4 4l4 4" /><path d="M17 8l4 4l-4 4" /><path d="M14 4l-4 16" /></svg>`,
  hexagonal: `<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="w-full h-full"><path d="M19.875 6.27c.7 .398 1.13 1.143 1.125 1.948v7.284c0 .809 -.443 1.555 -1.158 1.948l-6.75 4.27a2.269 2.269 0 0 1 -2.184 0l-6.75 -4.27a2.225 2.225 0 0 1 -1.158 -1.948v-7.285c0 -.809 .443 -1.554 1.158 -1.947l6.75 -3.98a2.33 2.33 0 0 1 2.25 0l6.75 3.98h-.033z" /></svg>`,
  event: `<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="w-full h-full"><path d="M13 3l0 7l6 0l-8 11l0 -7l-6 0l8 -11" /></svg>`,
  cicd: `<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="w-full h-full"><path d="M20 11a8.1 8.1 0 0 0 -15.5 -2m-.5 -4v4h4" /><path d="M4 13a8.1 8.1 0 0 0 15.5 2m.5 4v-4h-4" /></svg>`,
  ddd: `<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="w-full h-full"><path d="M8 8h8v8h-8z" /><path d="M4 4h16v16h-16z" /></svg>`,
  rundeck: `<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="w-full h-full"><path d="M2.146 12L0 14.146l4.293 4.293L8.586 14.146 6.44 12 8.586 9.854 4.293 5.561 0 9.854 2.146 12zM21.854 12l2.146 2.146-4.293 4.293-4.293-4.293L17.56 12l-2.146-2.146 4.293-4.293 4.293 4.293L21.854 12zM9.99 12l-2.147 2.146 4.293 4.293L16.436 14.146 14.29 12l2.146-2.146-4.293-4.293-4.293 4.293L9.99 12z" /></svg>`,
};

// Combined icons object
const icons = { ...iconComponents, ...inlineIcons };

type IconName = keyof typeof icons;

interface Skill {
  name: string;
  icon: IconName;
  color: string;
  bg: string;
  border: string;
  description: string;
}

const skills: Skill[][] = [
  // Row 1: Backend Frameworks & Languages (Scrolls Left)
  [
    {
      name: 'Laravel',
      icon: 'laravel',
      color: 'text-red-500',
      bg: 'bg-red-500/10',
      border: 'group-hover:border-red-500/50',
      description: 'Desarrollo de aplicaciones monolíticas y APIs RESTful desde la versión 5.'
    },
    {
      name: 'Symfony',
      icon: 'symfony',
      color: 'text-slate-200',
      bg: 'bg-slate-200/10',
      border: 'group-hover:border-slate-200/50',
      description: 'Construcción de aplicaciones empresariales robustas y componentes reutilizables.'
    },
    {
      name: 'NestJS',
      icon: 'nestjs',
      color: 'text-red-600',
      bg: 'bg-red-600/10',
      border: 'group-hover:border-red-600/50',
      description: 'Arquitectura modular y escalable para microservicios con TypeScript.'
    },
    {
      name: 'Express.js',
      icon: 'express',
      color: 'text-yellow-400',
      bg: 'bg-yellow-400/10',
      border: 'group-hover:border-yellow-400/50',
      description: 'APIs ligeras de alto rendimiento y middleware personalizado.'
    },
    {
      name: 'PHP',
      icon: 'php',
      color: 'text-indigo-400',
      bg: 'bg-indigo-400/10',
      border: 'group-hover:border-indigo-400/50',
      description: 'Dominio profundo del lenguaje, PHP 8+, JIT y programación asíncrona.'
    }
  ],
  // Row 2: Data, DevOps & Cloud (Scrolls Right)
  [
    {
      name: 'MySQL',
      icon: 'mysql',
      color: 'text-blue-500',
      bg: 'bg-blue-500/10',
      border: 'group-hover:border-blue-500/50',
      description: 'Optimización de queries, esquemas normalizados y alta disponibilidad.'
    },
    {
      name: 'Docker',
      icon: 'docker',
      color: 'text-blue-600',
      bg: 'bg-blue-600/10',
      border: 'group-hover:border-blue-600/50',
      description: 'Containerización y orquestación de entornos de desarrollo/prod.'
    },
    {
      name: 'Redis',
      icon: 'redis',
      color: 'text-red-500',
      bg: 'bg-red-500/10',
      border: 'group-hover:border-red-500/50',
      description: 'Caché en memoria, colas de mensajes y almacenamiento key-value.'
    },
    {
      name: 'MongoDB',
      icon: 'mongo',
      color: 'text-green-500',
      bg: 'bg-green-500/10',
      border: 'group-hover:border-green-500/50',
      description: 'Base de datos NoSQL para datos flexibles y gran volumen.'
    },
    {
      name: 'Git',
      icon: 'git',
      color: 'text-green-500',
      bg: 'bg-green-500/10',
      border: 'group-hover:border-green-500/50',
      description: 'Control de versiones y colaboración en proyectos.'
    },
    {
      name: 'ElasticSearch',
      icon: 'elasticsearch',
      color: 'text-blue-500',
      bg: 'bg-blue-500/10',
      border: 'group-hover:border-blue-500/50',
      description: 'Búsqueda en tiempo real y análisis de datos.'
    },
    {
      name: 'Kibana',
      icon: 'kibana',
      color: 'text-blue-500',
      bg: 'bg-blue-500/10',
      border: 'group-hover:border-blue-500/50',
      description: 'Visualización de datos y análisis de datos.'
    }
  ],
  // Row 3: Architecture & Concepts (Scrolls Left)
  [
    {
      name: 'Microservicios',
      icon: 'microservices',
      color: 'text-purple-500',
      bg: 'bg-purple-500/10',
      border: 'group-hover:border-purple-500/50',
      description: 'Sistemas distribuidos desacoplados y escalables independientemente.'
    },
    {
      name: 'Clean Code',
      icon: 'code',
      color: 'text-emerald-500',
      bg: 'bg-emerald-500/10',
      border: 'group-hover:border-emerald-500/50',
      description: 'Código legible, mantenible y testeable. Principios SOLID.'
    },
    {
      name: 'Arquitectura Hexagonal',
      icon: 'hexagonal',
      color: 'text-amber-500',
      bg: 'bg-amber-500/10',
      border: 'group-hover:border-amber-500/50',
      description: 'Puertos y adaptadores para aislar el dominio de la infraestructura.'
    },
    {
      name: 'Event Driven',
      icon: 'event',
      color: 'text-pink-500',
      bg: 'bg-pink-500/10',
      border: 'group-hover:border-pink-500/50',
      description: 'Arquitecturas reactivas y asíncronas basadas en eventos.'
    },
    {
      name: 'CI/CD',
      icon: 'cicd',
      color: 'text-cyan-400',
      bg: 'bg-cyan-400/10',
      border: 'group-hover:border-cyan-400/50',
      description: 'Pipelines automatizados para integración y despliegue continuo.'
    },
    {
      name: 'DDD',
      icon: 'ddd',
      color: 'text-blue-400',
      bg: 'bg-blue-400/10',
      border: 'group-hover:border-blue-400/50',
      description: 'Desarrollo guiado por dominio para garantizar robustez.'
    },
    {
      name: 'Rundeck',
      icon: 'rundeck',
      color: 'text-blue-400',
      bg: 'bg-blue-400/10',
      border: 'group-hover:border-blue-400/50',
      description: 'Orquestación de tareas y pipelines de automatización.'
    },
    {
      name: 'Ansible',
      icon: 'ansible',
      color: 'text-blue-400',
      bg: 'bg-blue-400/10',
      border: 'group-hover:border-blue-400/50',
      description: 'Orquestación de tareas y pipelines de automatización.'
    }
  ]
];
---

<section id="tech" class="relative min-h-screen py-20 overflow-hidden bg-slate-900 flex flex-col justify-center">
  <div class="absolute inset-0 pointer-events-none">
    <div class="absolute inset-0 bg-linear-to-b from-slate-900 via-slate-950 to-slate-900"></div>
    <div class="absolute inset-0 opacity-[0.03]">
      <div class="absolute inset-0" style="background-image: linear-gradient(to right, #3b82f6 1px, transparent 1px), linear-gradient(to bottom, #3b82f6 1px, transparent 1px); background-size: 40px 40px;"></div>
    </div>
  </div>

  <div class="relative z-10 w-full">
    <div class="container mx-auto px-6 text-center mb-16 animate-reveal">
      <h2 class="text-4xl md:text-5xl font-bold font-display mb-6">
        <span class="text-transparent bg-clip-text bg-linear-to-r from-blue-400 via-purple-400 to-emerald-400">
          Stack Tecnológico
        </span>
      </h2>
      <p class="text-xl text-slate-300 max-w-3xl mx-auto leading-relaxed">
        Experiencia técnica y principios de ingeniería
      </p>
    </div>

    <div class="space-y-8 md:space-y-12">
      
      {skills.map((row, rowIndex) => (
        <div class="select-none relative w-full overflow-hidden group/row mask-gradient-horizontal">
          <div class={`flex w-max space-x-6 animate-scroll-${rowIndex % 2 === 0 ? 'left' : 'right'} group-hover/row:paused`}>
            {[...row, ...row, ...row].map((skill) => (
              <div class="w-[280px] md:w-[320px] shrink-0">
                <div class={`group relative bg-slate-800/40 backdrop-blur-sm border border-slate-700/50 rounded-xl p-5 transition-all duration-300 hover:scale-105 hover:bg-slate-800/80 hover:shadow-2xl hover:z-10 ${skill.border}`}>
                  
                  <div class="flex items-center space-x-4">
                    <div class={`w-10 h-10 rounded-lg flex items-center justify-center shrink-0 ${skill.bg}`}>
                      {
                        typeof icons[skill.icon] === 'string'
                          ? <div class={`w-6 h-6 ${skill.color}`} set:html={icons[skill.icon]} />
                          : <icons[skill.icon] class={`w-6 h-6 ${skill.color}`} />
                      }
                    </div>
                    <h4 class="text-lg font-semibold font-display text-slate-200 group-hover:text-white transition-colors">
                      {skill.name}
                    </h4>
                  </div>

                  <div class="max-h-0 opacity-0 group-hover:max-h-40 group-hover:opacity-100 transition-all duration-500 ease-in-out overflow-hidden">
                    <div class="pt-3 border-t border-slate-700/50 mt-3">
                      <p class="text-sm text-slate-400 leading-relaxed font-body">
                        {skill.description}
                      </p>
                    </div>
                  </div>

                </div>
              </div>
            ))}
          </div>
        </div>
      ))}

    </div>
  </div>

  <style>
    .mask-gradient-horizontal {
      mask-image: linear-gradient(
        to right,
        transparent,
        black 10%,
        black 90%,
        transparent
      );
    }

    .group-hover\/row\:paused:hover {
      animation-play-state: paused;
    }

    @keyframes scroll-left {
      0% {
        transform: translateX(0);
      }
      100% {
        transform: translateX(-33.33%);
      }
    }

    @keyframes scroll-right {
      0% {
        transform: translateX(-33.33%);
      }
      100% {
        transform: translateX(0);
      }
    }

    .animate-scroll-left {
      animation: scroll-left 50s linear infinite;
    }

    .animate-scroll-right {
      animation: scroll-right 50s linear infinite;
    }

    /* Reduced Motion */
    @media (prefers-reduced-motion: reduce) {
      .animate-scroll-left,
      .animate-scroll-right {
        animation: none;
        transform: none;
      }
      
      .scrolling-wrapper-horizontal {
        overflow-x: auto;
        width: 100%;
      }
    }
  </style>
</section>
